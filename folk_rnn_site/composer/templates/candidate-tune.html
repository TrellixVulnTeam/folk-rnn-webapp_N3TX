<html>
    <head>
        <title>Folk RNN Composer – Candidate Tune</title>
        
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
        <link href="/static/abcjs-midi.css" media="all" rel="stylesheet" type="text/css" />
        <script src="/static/abcjs_editor_midi_3.1.4-min.js" type="text/javascript"></script>
        <style>
            .abcjs-inline-midi {
                max-width: 740px;
            }
        </style>
    </head>
    <body>
        <h1>Compose</h1>
        <div id="compose_ui">
            <p>The composition –</p>
            <textarea name="abc" id="abc" cols="80" rows="15">X: 1
T: Cooley's
M: 4/4
L: 1/8
R: reel
K: Emin
|:D2|EB{c}BA B2 EB|~B2 AB dBAG|FDAD BDAD|FDAD dAFD|
EBBA B2 EB|B2 AB defg|afe^c dBAF|DEFD E2:|
|:gf|eB B2 efge|eB B2 gedB|A2 FA DAFA|A2 FA defg|
eB B2 eBgB|eB B2 defg|afe^c dBAF|DEFD E2:|
            </textarea>
            <p>This was made with –<br>
                <ul>
                    <li>Seed: {{ seed }}</li>
                    <li>Requested at: {{ requested|date:"r" }}</li>
                    <li>Composition took: {{ rnn_duration|floatformat:"0" }}s</li>
                </ul>
            </p>
            <div id="midi"></div>
            <div id="midi-download"></div>
            <div id="warnings"></div>
            <div id="music"></div>
            <div id="paper0"></div>
            <div id="paper1"></div>
            <div id="paper2"></div>
            <div id="paper3"></div>
            <div id="selection"></div>
        </div>

        <script type="text/javascript">
            function selectionCallback(abcelem) {
                var note = {};
                for (var key in abcelem) {
                    if (abcelem.hasOwnProperty(key) && key !== "abselem")
                        note[key] = abcelem[key];
                }
                console.log(abcelem);
                var el = document.getElementById("selection");
                el.innerHTML = "<b>selectionCallback parameter:</b><br>" + JSON.stringify(note);
            }
        
            function initEditor() {
                new ABCJS.Editor("abc", { paper_id: "paper0",
                    generate_midi: true,
                    midi_id:"midi",
                    midi_download_id: "midi-download",
                    generate_warnings: true,
                    warnings_id:"warnings",
                    midi_options: {
                        generateDownload: true
                    },
                    render_options: {
                        listener: { highlight: selectionCallback }
                    }
                });
            }
        
            window.addEventListener("load", initEditor, false);
        </script>
    </body>
</html>